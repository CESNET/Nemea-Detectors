# HostStats configuration

# *** HostStatsNemea input interfaces ***

# The following parameters must be specified for each interface (ifc):
# <ifc>::port_flowdir - The source of flow direction. Flow direction determines
#             whether the flow is part of the request of response flow. 
#             If port_flowdir = 1, this module create a custom flow direction 
#             based on the ports of flow record (not so precise, but no extra 
#             module is required).
#             If port_flowdir = 0, this module require flow direction generated
#             by another module (e.g. flowdirection, deduplication,...). 
#             WARNING: if port_flowdir = 0, interface template MUST contain 
#                      "DIRECTION_FLAGS" e.g. <COLLECTOR_FLOW>,DIRECTION_FLAGS
# <ifc>::subprofiles - List of subprofiles to update. To disable updates of 
#             subprofile by this interface, comment line or leave empty after 
#             equal sign.
# <ifc::template - UniRec template of specified input interface. For more 
#             information, see the UniRec specification.

# Comma-separated list of active interfaces. 
# The order of these interfaces is the same as the order of TRAP input 
# interfaces. Parameters of these interfaces are given below. 
# Example: input_interfaces = ifc_default,ifc_sip
input_interfaces = ifc_default

ifc_default:port_flowdir = 1
ifc_default:subprofiles = dns,ssh
ifc_default:template = <COLLECTOR_FLOW>

# *** End of HostStatsNemea input interfaces


# Comma-separated list of detection rules
# The list contains names of detection rules, those will be used to search for 
# suspicious behavior in statistics records. Each name of subprofile can also be
# used as a detection rule. Among the detection rules belongs "generic" rule for
# global statistics. 
# List of available rules: generic, ssh, dns
# Warning: In case of using the subprofiles rules is REQUIRED that at least one
#          input interface contains the corresponding subprofile in the 
#          "subprofiles" section! Rule "generic" is not subprofile and can used
#          without any active subprofile.
rules = generic,ssh,dns

# Directory for detection log files
detection-log     = /data/hoststatsnemea/log/

# Verbosity level, see syslog.h(0p) for the list of priorities
log-upto-level    = LOG_INFO
#log-upto-level    = LOG_DEBUG

# Size of hash table (== maximum number of individual hosts)
# Value must be a power of two. If the value is not valid, module uses 
#   the smallest power of two that is greater or equal to a given value.
# The table size should be FOUR TIMES BIGGER than the expected maximum number of 
#   unique hosts on your network per timeout-active (5 minutes by default). 
# Warning: significantly affects the amount of required memory and performance 
#   of this module.
table-size = 1048576

# A record is released, when it is in the table longer than this time. [seconds]
timeout-active    = 300

# A record is released, if it wasn't updated during this time. [seconds]
timeout-inactive  = 30

# A detector controlling above timeouts starts periodically after 
# this time. [seconds]
det_start_time    = 10
