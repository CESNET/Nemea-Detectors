**************************** SDM controller nemea module *********************************

Table of Contents
=================
   
   1. Module description
   2. Interfaces
      2.1 Supported detectors
   3. How it works
   4. Outputs
   5. How to use


1. Module description
=====================

SDM controller is nemea module which receives data from multiple detectors or aggregators
and remotely controls probe with filter_storage plugin for capturing packets.


2. Interfaces
=============

Input: 1 - N Unirec records in format according to detectors' outputs
   N ... number of supported detectors/aggregators

Output: 1 Unirec record in format <SDM_CAPTURE_REQUEST>

2.1 Supported detectors
=======================

SDM controller can receive data from detectors:
   - hoststatsnemea (output: "EVENT_TYPE,TIME_FIRST,TIME_LAST,SRC_IP,DST_IP,SRC_PORT,DST_PORT,PROTOCOL,EVENT_SCALE")
   - dns_amplification (output: "<AMPLIFICATION_ALERT>")
   - slowthreatdetector (output: "<WARDEN_REPORT>")


3. How it works
===============

Detectors/aggregators which SDM controller receives data from are set through command line
arguments. For each detector is created one thread.

SDM controller extracts IP address of attacker if present (IP address of victim instead if
attacker's is not present), time of detection and type of attack.

Then it concatenates these items and creates ID of file in format:
<type of event>-<IP address>-<date and time>
<type of event>   ...   contains type of event (attack) and abbreviation of detector if event
                        is detected by more than one detector
                        example:
                        BRUTEFORCE:HS
                        (bruteforce attack detected by hoststats)
<IP address>      ...   string containing IP address
<date and time>   ...   string if format: YYYY-MM-DD-hh:mm:ss
                        YYYY  year
                        MM    month
                        DD    day
                        hh    hour
                        mm    minute
                        ss    second


4. Outputs
==========

SDM controller sends to ouput Unirec record in format <SDM_CAPTURE_REQUEST> which contains
following fields:
SRC_IP               - IP address of attacker (alternatively victim)
TIMEOUT              - maximal number of seconds for capturing packets (default 60)
PACKETS              - maximal number of packets to capture (default 10 000)
SDM_CAPTURE_FILE_ID  - ID of file where captured packets will be stored


5. How to use
=============

Options for setting input detectors:
--hoststats                hoststatsnemea detector
--dns_amplification        dns_amplification detector
--slowthreat               slowthreat detector

Input interfaces must be in same order as options for input detectors.

Setting timeout and packets:
-t N,--timeout=N     change timeout from default value (60) to N
-p n,--packets=N     change packets from default value (10 000) to N
For both options zero (0) means infinity.

Example - run module with value of timeout 10, packets 100 000, input from hoststatsnemea 
on localhost:6000, input from dns_amplification on localhost:7000 and sending output to 
port 8000:
   ./sdm_controller --hoststats --dns_amplification -t 10 -p 100000 -i "ttt;localhost,6000;localhost,7000;8000"

